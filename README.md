## Overview
This server was generated by the [OpenAPI Generator](https://openapi-generator.tech) project. By using the
[OpenAPI-Spec](https://openapis.org) from a remote server, you can easily generate a server stub. This
is an example of building a OpenAPI-enabled Python Flask server.

Swagger requires to predefine contract: ./openapi/openapi.yaml
and implement controllers: ./openapi_server/controllers/default_controller.py

## Running with Docker

**Requirements**
Docker Engine is to be preinstalled on host machine

To run the server on a Docker container, please execute the following from the repo root folder:

```bash
# building the image
docker build -t music-api .

# starting up a container
docker run --rm --name music-api -p 8080:8080 music-api 
```

## Try it out with UI

Open your browser to here:

```
http://localhost:8080/ui/
```

Click "Post" and "Try it out".

Input payload has to contain either artist name or artist id or both. Example:
```
{
  "artist": {
    "id": "83d91898-7763-47d7-b03b-b92132375c47",
    "name": "Pink Floyd"
  }
}
```
```
{
  "artist": {
    "name": "Pink Floyd"
  }
}
```
```
{
  "artist": {
    "id": "83d91898-7763-47d7-b03b-b92132375c47"
  }
}
```

If input payload does not conform to the spec error message is sent back.

Modify payload to suit your needs. 

## Try it out with curl 
```
curl -X POST "http://localhost:8080/music-api/artist" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"artist\":{\"id\":\"83d91898-7763-47d7-b03b-b92132375c47\",\"name\":\"Pink Floyd\"}}"
```

```
curl -X POST "http://localhost:8080/music-api/artist" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"artist\":{\"name\":\"Pink Floyd\"}}"
```

```
curl -X POST "http://localhost:8080/music-api/artist" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"artist\":{\"id\":\"83d91898-7763-47d7-b03b-b92132375c47\"}}"
```

## Cleanup environment 
```bash
docker stop music-api
docker rmi $(docker images --format '{{.Repository}}:{{.Tag}}' | grep 'music-api')
docker rmi $(docker images --format '{{.Repository}}:{{.Tag}}' | grep 'python:3-alpine')
```

## Running with Python 

**Requirements**
Python 3.5.2+ is to be preinstalled on host machine

## Usage
To run the server, please execute the following from the root directory:

```
pip3 install -r requirements.txt
python3 -m openapi_server
```

## Try it out using UI 
Check above Docker build "Try it out" section

## Integration tests 

To launch the integration tests, use tox:
```
sudo pip install tox
tox
```
